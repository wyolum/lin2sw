/**
 * Copyright MARS FLAG Corporation. All rights reserved.
 *
 * http://www.marsflag.com/
 */
function initJSONPSuggest(G,L){L=L||window.jQuery;if(!window.GALFSRAM){window.GALFSRAM={}}var E=G.interface_url||"suggest.x";var Y=G.handler_name||"parent.suggest_ctxt";var K=G.callback||"load_suggest";var R=G.selected_bgcolor||"#ddd";var F=G.max||10;var H=G.array_styles||[];var a=G.input_jquery;var V=G.suggest_frame||"suggest_frame";var I=G.no_result_mess||"";var N=G.array_queries;var J=G.show_data_graph;var c="suggest_area";var X=G.to_upper;var A=G.debug;var Q;var T=navigator.userAgent;var S=function(AL){if(Q){return }try{AL=AL||window.event;if(AL&&AL.type=="readystatechange"&&this.readyState!="complete"){return }if(U){clearInterval(U)}Q=true;if(!(b||P)){C.onload=C.onreadystatechange=null}var g=C.contentWindow||window.frames[V];var o=g.document;var s=false;var h=H.join("")+(J?"":".suggest_data_graph {display:none}");if(b||P){o.body.innerHTML="";if(H){var v=o.createElement("style");v.type="text/css";if(P){v.styleSheet.cssText=h}else{v.innerHTML=h}o.body.appendChild(v)}var f=o.createElement("div");f.id=c;o.body.appendChild(f)}else{if(H){o.write('<style type="text/css"><!-- '+h+"--></style>")}o.write('<body><div id="'+c+'"></div></body>');o.close();var f=o.getElementById(c)}o.body.scroll="no";var u=function(){var e=a.css("font-size");var AQ=a.css("font-family");var AP=a.css("height");var AR=o.styleSheets&&o.styleSheets[0];if(AR.addRule){AR.addRule("body *","font-size:"+e+" !important");AR.addRule("body *","font-family:"+AQ+" !important");AR.addRule("#suggest_area td","height:"+AP+" !important")}else{AR.insertRule("body * {font-size:"+e+"}",AR.cssRules.length);AR.insertRule("body * {font-family:"+AQ+"}",AR.cssRules.length);AR.insertRule("#suggest_area td {height:"+AP+" !important}",AR.cssRules.length)}};u();f.onselectstart=f.oncontextmenu=function(){return false};var AB="suggest_data_";var y=Y;var x=y.replace(/^[^.]*\.(.*)$/,"$1");if(!GALFSRAM[x]){GALFSRAM[x]={}}var AJ=function(){M.css("visibility","visible")};var p=function(){M.css("visibility","hidden")};var AK=function(e,AP){if(!arguments.length){var AQ=o.getElementsByTagName("TABLE")[0];e=AQ.offsetWidth;AP=AQ.offsetHeight;if(D){e+=3;AP++}}C.style.width=e+"px";C.style.height=AP+"px"};GALFSRAM[x]["resize_suggest"]=AK;var w=function(){return M.css("visibility")=="visible"};var t=function(e){return o.getElementById(e)};var AO=window.onresize;window.onresize=function(){j();if(AO){AO()}};var j=function(){var e=a[0];var AP=YAHOO.util.Dom.getXY(e);C.style.left=(AP[0]-(P?2:0))+"px";C.style.top=(AP[1]+e.offsetHeight-(P?2:0))+"px";C.style.width=e.offsetWidth+"px"};GALFSRAM[K]=function(AP){s=false;if(!AP||AP.length==0){if(!I){return }s=true}if(X){for(var AR=0;AR<AP.length;AR++){AP[AR].word=AP[AR].word.toUpperCase()}}j();if(!a.val()){return }var AQ={prefix:AB,handler:y,handler:"parent.GALFSRAM."+x,data:AP};if(s){AQ.data=[{word:I,point:-1}]}try{suggest_tmpl(AQ,f);setTimeout("GALFSRAM."+x+"['resize_suggest']()",0);l=AP;AH=-1;AJ()}catch(AS){if(A){alert(Z(AS))}}};var AE=function(e){if(e.match(/^\s*$/)){return false}var AQ=["callback=GALFSRAM."+K,"q="+encodeURIComponent(e),"ie=utf8","max="+F,"d="+(+new Date)];if(N){AQ=AQ.concat(N)}var AP=E+"?"+AQ.join("&");jsonp.load("jsonp_suggest",AP,"UTF-8");return AP};var AG=a.val();var l=[];var AH=-1;var AD=function(e){if(typeof e!="undefined"){AF();AH=e}if(l[AH]){var AP=t(AB+AH);AP.backgroundColorOrg=AP.style.backgroundColor;AP.style.backgroundColor=R}};GALFSRAM[x]["focus"]=AD;var AF=function(){if(l[AH]){var e=t(AB+AH);e.style.backgroundColor=e.backgroundColorOrg}};var AN=function(){if(AH<0){AH=0}else{AF();AH++}if(AH>=l.length){AH=-1;return }AD()};var r=function(){if(AH<0){AH=l.length-1}else{AF();AH--;if(AH==-1){return }}AD()};var AM=function(){var e=l[AH];if(e){if(a.val()!=e.word){a.val(e.word);AG=e.word;AE(e.word+" ");return false}}return true};var AA;GALFSRAM[x]["suggest_mousedown"]=function(AP){if(s){return }AA=(new Date()).getTime()};GALFSRAM[x]["suggest_click"]=function(AP){if(s){return false}if(AM()){a[0].form.submit()}else{a[0].focus();return false}};var i={"9":"tab","16":"shift","17":"ctl","27":"esc","18":"alt","19":"pause/break","20":"caps lock","33":"pageup","34":"pagedown","35":"end","36":"home","37":"left","38":"up","40":"down","44":"print screen","45":"ins"};var z=false;var AC=function(AQ){var AP=AQ.keyCode;z=AQ.shiftKey;if(AP==13&&AH!=-1){return false}if(i[AP]){return false}return true};var q=function(){var e=a.val();if(AG==e){return }AG=e;if(e==""){l=[];p()}else{AE(e)}};var k;var n=function(){if(!k){k=setInterval(q,100)}};var m=function(){if(!k){return }clearInterval(k);k=null};var AI={keyup:function(AP){(AC(AP)!=false)&&q()},keypress:function(AP){(AC(AP)!=false)&&n()},keydown:function(AQ){var AP=AQ.keyCode;z=AQ.shiftKey;switch(AP){case 9:if(!w()){return true}if(z){r()}else{AN()}break;case 40:AN();break;case 38:r();break;case 27:p();break;case 13:if(!AM()){break}default:if(T.indexOf("Gecko")>=0){(AC(AQ)!=false)&&n()}return }return false},blur:function(AQ){var AP=(new Date()).getTime();if(AA+100>AP){return }m();p()},focus:function(AP){if(l.length==0&&!s){return }AJ()}};if(window.opera||(T.indexOf("Gecko")>=0&&T.indexOf("KHTML")==-1)){a.keypress(AI.keypress)}else{a.keyup(AI.keyup)}a.keydown(AI.keydown).blur(AI.blur).focus(AI.focus)}catch(AL){if(A){alert(Z(AL))}}};var Z=function(g){var e,f=[];for(e in g){f[f.length]=e+" :\t"+g[e]}return f.join("\n")};var U;var D=T.match(/AppleWebKit\/4\d\d/);var b=T.match(/Opera/);var P=T.match(/MSIE/);var O=T.match(/MSIE 6/);var W=T.match(/(iPhone|iPad|iPod|Android|dream|CUPCAKE|blackberry|webOS|incognito|webmate)/);var d=O?"javascript:false;":"about:blank";if(typeof (a)=="string"){a=L(a)}if(!a||!a[0]){return }a.attr("autocomplete","off");var M=L("#"+V);var C=M.get(0);var B=false;if(M.length==0){C=document.createElement("IFRAME");M=L(C);B=true}C.name=C.id=V;C.frameBorder=0;C.scrolling="no";M.css({position:"absolute",visibility:"hidden",zIndex:10000,top:"0px",height:"0px",width:a[0].offsetWidth+"px",border:"0px"});if(!B){M.css("display","block")}if(B){L(document.body).append(C)}else{M.prependTo(L(document.body))}if(!(b||P)){C.onload=C.onreadystatechange=S;C.src=d}if(D||b||P){U=setInterval(S,100)}};